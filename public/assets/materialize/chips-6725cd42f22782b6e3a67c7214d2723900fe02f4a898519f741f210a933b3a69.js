!function(e){var t={data:[],placeholder:"",secondaryPlaceholder:"",autocompleteOptions:{}};e(document).on("turbolinks:load",function(){e(document).on("click",".chip .close",function(){e(this).closest(".chips").attr("data-initialized")||e(this).closest(".chip").remove()})}),e.fn.material_chip=function(i){var c=this;if(this.$el=e(this),this.$document=e(document),this.SELS={CHIPS:".chips",CHIP:".chip",INPUT:"input",DELETE:".material-icons",SELECTED_CHIP:".selected"},"data"===i)return this.$el.data("chips");var a=e.extend({},t,i);c.hasAutocomplete=!e.isEmptyObject(a.autocompleteOptions.data),this.init=function(){var t=0;c.$el.each(function(){var i=e(this),s=Materialize.guid();c.chipId=s,a.data&&a.data instanceof Array||(a.data=[]),i.data("chips",a.data),i.attr("data-index",t),i.attr("data-initialized",!0),i.hasClass(c.SELS.CHIPS)||i.addClass("chips"),c.chips(i,s),t++})},this.handleEvents=function(){var t=c.SELS;c.$document.off("click.chips-focus",t.CHIPS).on("click.chips-focus",t.CHIPS,function(i){e(i.target).find(t.INPUT).focus()}),c.$document.off("click.chips-select",t.CHIP).on("click.chips-select",t.CHIP,function(i){var a=e(i.target);if(a.length){var s=a.hasClass("selected"),n=a.closest(t.CHIPS);e(t.CHIP).removeClass("selected"),s||c.selectChip(a.index(),n)}}),c.$document.off("keydown.chips").on("keydown.chips",function(i){if(!e(i.target).is("input, textarea")){var a,s=c.$document.find(t.CHIP+t.SELECTED_CHIP),n=s.closest(t.CHIPS),o=s.siblings(t.CHIP).length;if(s.length)if(8===i.which||46===i.which){i.preventDefault(),a=s.index(),c.deleteChip(a,n);var l=null;a+1<o?l=a:a!==o&&a+1!==o||(l=o-1),l<0&&(l=null),null!==l&&c.selectChip(l,n),o||n.find("input").focus()}else if(37===i.which){if((a=s.index()-1)<0)return;e(t.CHIP).removeClass("selected"),c.selectChip(a,n)}else if(39===i.which){if(a=s.index()+1,e(t.CHIP).removeClass("selected"),a>o)return void n.find("input").focus();c.selectChip(a,n)}}}),c.$document.off("focusin.chips",t.CHIPS+" "+t.INPUT).on("focusin.chips",t.CHIPS+" "+t.INPUT,function(i){var c=e(i.target).closest(t.CHIPS);c.addClass("focus"),c.siblings("label, .prefix").addClass("active"),e(t.CHIP).removeClass("selected")}),c.$document.off("focusout.chips",t.CHIPS+" "+t.INPUT).on("focusout.chips",t.CHIPS+" "+t.INPUT,function(i){var c=e(i.target).closest(t.CHIPS);c.removeClass("focus"),c.data("chips").length||c.siblings("label").removeClass("active"),c.siblings(".prefix").removeClass("active")}),c.$document.off("keydown.chips-add",t.CHIPS+" "+t.INPUT).on("keydown.chips-add",t.CHIPS+" "+t.INPUT,function(i){var a=e(i.target),s=a.closest(t.CHIPS),n=s.children(t.CHIP).length;if(13===i.which){if(c.hasAutocomplete&&s.find(".autocomplete-content.dropdown-content").length&&s.find(".autocomplete-content.dropdown-content").children().length)return;return i.preventDefault(),c.addChip({tag:a.val()},s),void a.val("")}if((8===i.keyCode||37===i.keyCode)&&""===a.val()&&n)return i.preventDefault(),c.selectChip(n-1,s),void a.blur()}),c.$document.off("click.chips-delete",t.CHIPS+" "+t.DELETE).on("click.chips-delete",t.CHIPS+" "+t.DELETE,function(i){var a=e(i.target),s=a.closest(t.CHIPS),n=a.closest(t.CHIP);i.stopPropagation(),c.deleteChip(n.index(),s),s.find("input").focus()})},this.chips=function(t,i){t.empty(),t.data("chips").forEach(function(e){t.append(c.renderChip(e))}),t.append(e('<input id="'+i+'" class="input" placeholder="">')),c.setPlaceholder(t);var s=t.next("label");s.length&&(s.attr("for",i),t.data("chips").length&&s.addClass("active"));var n=e("#"+i);c.hasAutocomplete&&(a.autocompleteOptions.onAutocomplete=function(e){c.addChip({tag:e},t),n.val(""),n.focus()},n.autocomplete(a.autocompleteOptions))},this.renderChip=function(t){if(t.tag){var i=e('<div class="chip"></div>');return i.text(t.tag),i.append(e('<i class="material-icons close">close</i>')),i}},this.setPlaceholder=function(e){e.data("chips").length&&a.placeholder?e.find("input").prop("placeholder",a.placeholder):!e.data("chips").length&&a.secondaryPlaceholder&&e.find("input").prop("placeholder",a.secondaryPlaceholder)},this.isValid=function(e,t){for(var i=e.data("chips"),c=!1,a=0;a<i.length;a++)if(i[a].tag===t.tag)return void(c=!0);return""!==t.tag&&!c},this.addChip=function(e,t){if(c.isValid(t,e)){for(var i=c.renderChip(e),a=[],s=t.data("chips"),n=0;n<s.length;n++)a.push(s[n]);a.push(e),t.data("chips",a),i.insertBefore(t.find("input")),t.trigger("chip.add",e),c.setPlaceholder(t)}},this.deleteChip=function(e,t){var i=t.data("chips")[e];t.find(".chip").eq(e).remove();for(var a=[],s=t.data("chips"),n=0;n<s.length;n++)n!==e&&a.push(s[n]);t.data("chips",a),t.trigger("chip.delete",i),c.setPlaceholder(t)},this.selectChip=function(e,t){var i=t.find(".chip").eq(e);i&&!1===i.hasClass("selected")&&(i.addClass("selected"),t.trigger("chip.select",t.data("chips")[e]))},this.getChipsElement=function(e,t){return t.eq(e)},this.init(),this.handleEvents()}}(jQuery);